import{s as R,c as fe,u as de,g as he,a as me,x as _e,i as pe,r as ge,o as ve,y as W,n as oe}from"../chunks/scheduler.CdkXGkJ4.js";import{S as J,i as Q,e as C,c as k,d as q,g as w,o as g,j as I,y as G,t as N,a as B,m as X,q as ae,n as re,s as y,u as F,z as H,h as D,v as L,k as b,A as Z,w as O,x as U,b as T,f as z,B as be,l as x}from"../chunks/index.D-k3M52J.js";function ee(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function we(s){let e,t,n,l,r;const i=s[5].default,d=fe(i,s,s[4],null);return{c(){e=C("button"),d&&d.c(),this.h()},l(c){e=k(c,"BUTTON",{class:!0,type:!0});var o=q(e);d&&d.l(o),o.forEach(w),this.h()},h(){g(e,"class",t="button "+s[1]+" "+s[0]+" svelte-1ntdbj4"),g(e,"type",s[2]),e.disabled=s[3]},m(c,o){I(c,e,o),d&&d.m(e,null),n=!0,l||(r=G(e,"click",s[6]),l=!0)},p(c,[o]){d&&d.p&&(!n||o&16)&&de(d,i,c,c[4],n?me(i,c[4],o,null):he(c[4]),null),(!n||o&3&&t!==(t="button "+c[1]+" "+c[0]+" svelte-1ntdbj4"))&&g(e,"class",t),(!n||o&4)&&g(e,"type",c[2]),(!n||o&8)&&(e.disabled=c[3])},i(c){n||(N(d,c),n=!0)},o(c){B(d,c),n=!1},d(c){c&&w(e),d&&d.d(c),l=!1,r()}}}function $e(s,e,t){let{$$slots:n={},$$scope:l}=e,{className:r=""}=e,{variant:i="primary"}=e,{type:d="button"}=e,{disabled:c=!1}=e;function o(m){_e.call(this,s,m)}return s.$$set=m=>{"className"in m&&t(0,r=m.className),"variant"in m&&t(1,i=m.variant),"type"in m&&t(2,d=m.type),"disabled"in m&&t(3,c=m.disabled),"$$scope"in m&&t(4,l=m.$$scope)},[r,i,d,c,l,n,o]}class K extends J{constructor(e){super(),Q(this,e,$e,we,R,{className:0,variant:1,type:2,disabled:3})}}function te(s){let e,t,n,l="Ã—",r,i,d="Enter PIN",c,o,m,_,u,P,a;return _=new K({props:{type:"submit",$$slots:{default:[Ce]},$$scope:{ctx:s}}}),_.$on("click",s[3]),{c(){e=C("div"),t=C("div"),n=C("button"),n.textContent=l,r=y(),i=C("h2"),i.textContent=d,c=y(),o=C("input"),m=y(),F(_.$$.fragment),this.h()},l(f){e=k(f,"DIV",{class:!0});var h=q(e);t=k(h,"DIV",{class:!0});var v=q(t);n=k(v,"BUTTON",{class:!0,"data-svelte-h":!0}),H(n)!=="svelte-1863m0g"&&(n.textContent=l),r=D(v),i=k(v,"H2",{"data-svelte-h":!0}),H(i)!=="svelte-zcibv1"&&(i.textContent=d),c=D(v),o=k(v,"INPUT",{type:!0,inputmode:!0,pattern:!0,placeholder:!0,autocomplete:!0,class:!0}),m=D(v),L(_.$$.fragment,v),v.forEach(w),h.forEach(w),this.h()},h(){g(n,"class","close svelte-h208v3"),g(o,"type","password"),g(o,"inputmode","numeric"),g(o,"pattern","[0-9]*"),g(o,"placeholder","Enter PIN"),g(o,"autocomplete","one-time-code"),g(o,"class","svelte-h208v3"),g(t,"class","modal-content svelte-h208v3"),g(e,"class","modal svelte-h208v3")},m(f,h){I(f,e,h),b(e,t),b(t,n),b(t,r),b(t,i),b(t,c),b(t,o),Z(o,s[2]),b(t,m),O(_,t,null),u=!0,P||(a=[G(n,"click",function(){pe(s[1])&&s[1].apply(this,arguments)}),G(o,"input",s[5])],P=!0)},p(f,h){s=f,h&4&&o.value!==s[2]&&Z(o,s[2]);const v={};h&64&&(v.$$scope={dirty:h,ctx:s}),_.$set(v)},i(f){u||(N(_.$$.fragment,f),u=!0)},o(f){B(_.$$.fragment,f),u=!1},d(f){f&&w(e),U(_),P=!1,ge(a)}}}function Ce(s){let e;return{c(){e=T("Sign In")},l(t){e=z(t,"Sign In")},m(t,n){I(t,e,n)},d(t){t&&w(e)}}}function ke(s){let e,t,n=s[0]&&te(s);return{c(){n&&n.c(),e=X()},l(l){n&&n.l(l),e=X()},m(l,r){n&&n.m(l,r),I(l,e,r),t=!0},p(l,[r]){l[0]?n?(n.p(l,r),r&1&&N(n,1)):(n=te(l),n.c(),N(n,1),n.m(e.parentNode,e)):n&&(ae(),B(n,1,1,()=>{n=null}),re())},i(l){t||(N(n),t=!0)},o(l){B(n),t=!1},d(l){l&&w(e),n&&n.d(l)}}}function Pe(s,e,t){let{show:n=!1}=e,{authenticate:l}=e,{close:r}=e,i="";const d=()=>{l(i),t(2,i="")};function c(){i=this.value,t(2,i)}return s.$$set=o=>{"show"in o&&t(0,n=o.show),"authenticate"in o&&t(4,l=o.authenticate),"close"in o&&t(1,r=o.close)},[n,r,i,d,l,c]}class Se extends J{constructor(e){super(),Q(this,e,Pe,ke,R,{show:0,authenticate:4,close:1})}}const Ee="KiddieCoinsDB",j="people",ne=[{name:"Everett",coins:0,img:"images/everett.webp"},{name:"Ellison",coins:0,img:"images/ellison.webp"},{name:"River",coins:0,img:"images/river.webp"}];function ie(){return new Promise((s,e)=>{const t=indexedDB.open(Ee,1);t.onupgradeneeded=n=>{const l=n.target.result;let r;l.objectStoreNames.contains(j)||(r=l.createObjectStore(j,{keyPath:"name"}),ne.forEach(i=>{r.add(i)}))},t.onsuccess=n=>{const l=n.target.result;l.transaction(j).objectStore(j).count().onsuccess=r=>{if(r.target.result===0){const i=l.transaction(j,"readwrite"),d=i.objectStore(j);ne.forEach(c=>d.add(c)),i.oncomplete=()=>s(l),i.onerror=c=>e(c.target.error)}else s(l)}},t.onerror=n=>e(n.target.error)})}async function Ne(s){const t=(await ie()).transaction(j,"readwrite"),n=t.objectStore(j);return s.forEach(l=>{n.put(l)}),new Promise((l,r)=>{t.oncomplete=()=>l(),t.onerror=()=>r(t.error)})}async function Ie(){const t=(await ie()).transaction(j,"readonly").objectStore(j);return new Promise((n,l)=>{const r=t.getAll();r.onsuccess=()=>n(r.result),r.onerror=()=>l(r.error)})}function se(s,e,t){const n=s.slice();return n[9]=e[t],n[11]=t,n}function ye(s){let e;return{c(){e=T("Login")},l(t){e=z(t,"Login")},m(t,n){I(t,e,n)},d(t){t&&w(e)}}}function De(s){let e,t="-";return{c(){e=C("span"),e.textContent=t,this.h()},l(n){e=k(n,"SPAN",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-1vs2q8l"&&(e.textContent=t),this.h()},h(){g(e,"class","plus-minus svelte-1suvo2d")},m(n,l){I(n,e,l)},p:oe,d(n){n&&w(e)}}}function je(s){let e,t="+";return{c(){e=C("span"),e.textContent=t,this.h()},l(n){e=k(n,"SPAN",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-1i4yz6j"&&(e.textContent=t),this.h()},h(){g(e,"class","plus-minus svelte-1suvo2d")},m(n,l){I(n,e,l)},p:oe,d(n){n&&w(e)}}}function le(s){let e,t,n,l,r,i,d,c=s[9].name+"",o,m,_,u=s[9].coins+"",P,a,f,h,v,p,M,A;function ce(){return s[6](s[11])}h=new K({props:{variant:"secondary",disabled:s[2],$$slots:{default:[De]},$$scope:{ctx:s}}}),h.$on("click",ce);function ue(){return s[7](s[11])}return p=new K({props:{disabled:s[2],$$slots:{default:[je]},$$scope:{ctx:s}}}),p.$on("click",ue),{c(){e=C("div"),t=C("img"),r=y(),i=C("div"),d=C("h3"),o=T(c),m=y(),_=C("p"),P=T(u),a=T(" coins"),f=y(),F(h.$$.fragment),v=y(),F(p.$$.fragment),M=y(),this.h()},l(S){e=k(S,"DIV",{class:!0});var $=q(e);t=k($,"IMG",{src:!0,alt:!0,class:!0}),r=D($),i=k($,"DIV",{class:!0});var E=q(i);d=k(E,"H3",{});var V=q(d);o=z(V,c),V.forEach(w),m=D(E),_=k(E,"P",{});var Y=q(_);P=z(Y,u),a=z(Y," coins"),Y.forEach(w),f=D(E),L(h.$$.fragment,E),v=D(E),L(p.$$.fragment,E),E.forEach(w),M=D($),$.forEach(w),this.h()},h(){W(t.src,n=s[9].img)||g(t,"src",n),g(t,"alt",l=s[9].name),g(t,"class","person-image svelte-1suvo2d"),g(i,"class","card-body svelte-1suvo2d"),g(e,"class","card svelte-1suvo2d")},m(S,$){I(S,e,$),b(e,t),b(e,r),b(e,i),b(i,d),b(d,o),b(i,m),b(i,_),b(_,P),b(_,a),b(i,f),O(h,i,null),b(i,v),O(p,i,null),b(e,M),A=!0},p(S,$){s=S,(!A||$&1&&!W(t.src,n=s[9].img))&&g(t,"src",n),(!A||$&1&&l!==(l=s[9].name))&&g(t,"alt",l),(!A||$&1)&&c!==(c=s[9].name+"")&&x(o,c),(!A||$&1)&&u!==(u=s[9].coins+"")&&x(P,u);const E={};$&4&&(E.disabled=s[2]),$&4096&&(E.$$scope={dirty:$,ctx:s}),h.$set(E);const V={};$&4&&(V.disabled=s[2]),$&4096&&(V.$$scope={dirty:$,ctx:s}),p.$set(V)},i(S){A||(N(h.$$.fragment,S),N(p.$$.fragment,S),A=!0)},o(S){B(h.$$.fragment,S),B(p.$$.fragment,S),A=!1},d(S){S&&w(e),U(h),U(p)}}}function Be(s){let e,t,n="Kiddie Coins",l,r,i,d,c,o,m;r=new K({props:{variant:"secondary",$$slots:{default:[ye]},$$scope:{ctx:s}}}),r.$on("click",s[4]),d=new Se({props:{show:s[1],authenticate:s[3],close:s[4]}});let _=ee(s[0]),u=[];for(let a=0;a<_.length;a+=1)u[a]=le(se(s,_,a));const P=a=>B(u[a],1,1,()=>{u[a]=null});return{c(){e=C("div"),t=C("h1"),t.textContent=n,l=y(),F(r.$$.fragment),i=y(),F(d.$$.fragment),c=y(),o=C("div");for(let a=0;a<u.length;a+=1)u[a].c();this.h()},l(a){e=k(a,"DIV",{class:!0});var f=q(e);t=k(f,"H1",{"data-svelte-h":!0}),H(t)!=="svelte-d1y84k"&&(t.textContent=n),l=D(f),L(r.$$.fragment,f),f.forEach(w),i=D(a),L(d.$$.fragment,a),c=D(a),o=k(a,"DIV",{class:!0});var h=q(o);for(let v=0;v<u.length;v+=1)u[v].l(h);h.forEach(w),this.h()},h(){g(e,"class","header svelte-1suvo2d"),g(o,"class","container svelte-1suvo2d")},m(a,f){I(a,e,f),b(e,t),b(e,l),O(r,e,null),I(a,i,f),O(d,a,f),I(a,c,f),I(a,o,f);for(let h=0;h<u.length;h+=1)u[h]&&u[h].m(o,null);m=!0},p(a,[f]){const h={};f&4096&&(h.$$scope={dirty:f,ctx:a}),r.$set(h);const v={};if(f&2&&(v.show=a[1]),d.$set(v),f&37){_=ee(a[0]);let p;for(p=0;p<_.length;p+=1){const M=se(a,_,p);u[p]?(u[p].p(M,f),N(u[p],1)):(u[p]=le(M),u[p].c(),N(u[p],1),u[p].m(o,null))}for(ae(),p=_.length;p<u.length;p+=1)P(p);re()}},i(a){if(!m){N(r.$$.fragment,a),N(d.$$.fragment,a);for(let f=0;f<_.length;f+=1)N(u[f]);m=!0}},o(a){B(r.$$.fragment,a),B(d.$$.fragment,a),u=u.filter(Boolean);for(let f=0;f<u.length;f+=1)B(u[f]);m=!1},d(a){a&&(w(e),w(i),w(c),w(o)),U(r),U(d,a),be(u,a)}}}function qe(){const s=new Date,e=String(s.getMonth()+1).padStart(2,"0"),t=String(s.getDate()).padStart(2,"0"),n=String(s.getFullYear()).slice(-2);return e+t+n}function Ae(s,e,t){let n=[];ve(async()=>{t(0,n=await Ie())});let l=!1,r=!1,i=!1;function d(u){const P=qe();u===P?(r=!0,t(1,l=!1)):alert("Incorrect PIN")}function c(){t(1,l=!l)}async function o(u,P=!0){if(!r){alert("You must be signed in to edit coins!");return}const{coins:a}=n[u],f=P?a+1:a-1;if(f<0){alert("Coin count cannot be negative.");return}t(2,i=!0);try{t(0,n[u].coins=f,n),await Ne(n)}catch(h){console.error("Failed to update coins:",h),alert("Failed to update coins.")}finally{t(2,i=!1)}}return[n,l,i,d,c,o,u=>o(u,!1),u=>o(u)]}class Te extends J{constructor(e){super(),Q(this,e,Ae,Be,R,{})}}export{Te as component};
